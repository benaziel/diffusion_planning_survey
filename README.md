# diffusion-based trajectory generation in mazes

this repo contains the code for a class project on using diffusion models to generate trajectories in a fixed maze environment. the model is trained on demonstration paths from a classical planner and learns to generate full trajectories conditioned only on start and goal positions.

the goal is not to replace classical planners, but to study how diffusion models behave when applied to a structured planning problem with geometric constraints.

## overview

the model learns a distribution over entire trajectories instead of predicting actions step by step. at inference time, trajectories are sampled from the reverse diffusion process without access to the maze layout. obstacle avoidance is encouraged indirectly through a collision-aware loss applied during training and through best-of-k selection during evaluation.

## repo structure

* `config.yaml`

experiment configuration (model size, diffusion params, training hyperparams

* `dataset.py`

dataset definition for maze trajs

* `maze\_env.py`

maze gen and env utils

* `trajectories.npy`

demonstration trajs generated by a classical planner (in this case bfs)

* `maze\_layout.npy`

binary occupancy grid for the fixed maze

* `model.py`

temporal u-net denoiser and diffusion process implementation

* `train.py`

training script with diffusion + collision-aware loss

* `evaluate.py`

sampling and viz script (best-of-k, qualitative plots)

* `utils.py`

misc helper fns

a gpu is recommended but not strictly required.

## running

to generate a new maze/set of trajs

`python maze\\\_env.py`



to train diffusion from scratch

`python train.py`



to sample and visualize trajectories using trained model

`python evaluate.py`



and that's that!

